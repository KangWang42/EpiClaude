---
name: paper-writing
description: |
  学术论文生成技能。根据分析结果自动生成完整的中文学术论文（Introduction/Methods/Results/Discussion）。
  触发场景：(1) 用户说"写论文"、"生成论文"、"论文初稿"；(2) 需要根据结果汇总生成论文；(3) 需要论文各部分模板。
---

# 学术论文生成技能

## 字数要求 (必须遵守!)

| 部分 | 字数要求 | 段落数 |
|------|----------|--------|
| **摘要** | 300-500字 | 1段 |
| **引言** | 800-1200字 | 3-4段 |
| **方法** | 1000-1500字 | 4-5节 |
| **结果** | 1500-2500字 | 按分析分节 |
| **讨论** | 1500-2000字 | 4-5段 |
| **总计** | **5500-7500字** | - |

> ⚠️ 生成论文时必须达到上述字数要求，否则论文不完整！

---

## 执行流程

### 1. 读取结果

首先读取 `07_paper/0_result_summaries.md` 获取分析结果。

### 2. 分部生成

**严格按以下顺序和字数要求生成：**

#### 摘要 (300-500字)
- 目的 (1-2句)
- 方法 (2-3句)
- 结果 (3-4句，含关键数值)
- 结论 (1-2句)

#### 引言 (800-1200字, 3-4段)
- 第1段：研究背景与疾病负担 (200-300字)
- 第2段：既往研究与不足 (250-350字)
- 第3段：研究意义 (150-250字)
- 第4段：研究目的 (100-150字)

#### 方法 (1000-1500字, 4-5节)
- 研究设计 (100-150字)
- 研究对象 (200-300字)
- 变量定义 (300-400字)
- 统计分析 (300-400字)
- 伦理声明 (50-100字)

#### 结果 (1500-2500字)
- 研究对象特征 (400-600字，含Table 1描述)
- 主分析结果 (600-1000字，含关键Table/Figure)
- 敏感性分析 (300-500字)
- 亚组分析 (200-400字，如有)

#### 讨论 (1500-2000字, 4-5段)
- 第1段：主要发现总结 (200-300字)
- 第2段：与既往研究比较 (400-500字)
- 第3段：可能机制 (300-400字)
- 第4段：优势与局限 (400-500字)
- 第5段：结论与建议 (150-200字)

---

## 写作规范

1. **不编造数据**: 所有数值来自 `0_result_summaries.md`
2. **学术语言**: 被动语态，避免第一人称
3. **中文为主**: 专业术语可保留英文缩写
4. **引用占位**: 用 `[待补充引用]` 标记

---

## 模板参考

详见 [templates.md](references/templates.md)

---

## 输出

使用 `officer` 包生成 Word 文档：

```r
library(officer)
doc <- read_docx() |>
  body_add_par("标题", style = "heading 1") |>
  body_add_par("正文内容...")
print(doc, target = "07_paper/论文初稿.docx")
```

---

## 检查清单

生成后自查：

- [ ] 摘要 300-500 字
- [ ] 引言 800-1200 字
- [ ] 方法 1000-1500 字
- [ ] 结果 1500-2500 字
- [ ] 讨论 1500-2000 字
- [ ] 总字数 5500-7500 字
- [ ] 所有数值来源于结果汇总
- [ ] 已标记 [待补充引用]
